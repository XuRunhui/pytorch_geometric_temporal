data:
  data_dir: /home/xu/clean_data
  use_factors: true
  sequence_length: 30
  prediction_horizons:
  - 1
  - 5
  - 10
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
  num_workers: 4
  normalize_features: true
  normalize_targets: true
  normalization_method: zscore
  persistent_workers: true
  drop_last: true
  pin_memory: true
  shuffle_train: true
  max_stocks: null
  start_date: null
  end_date: null
model:
  node_feat_dim: null
  gru_hidden_dim: 64
  gnn_hidden_dim: 128
  k_nn: 8
  add_self_loops: true
  output_dim: 32
  lr: 0.001
  weight_decay: 0.0001
  scheduler:
    type: plateau
    patience: 5
    factor: 0.5
    min_lr: 1.0e-06
    T_max: 100
    step_size: 30
    gamma: 0.1
  metric_compute_frequency: 10
  dropout: 0.1
  batch_norm: true
  adjacency:
    method: knn
    symmetric: true
    add_self_loops: ${model.add_self_loops}
  gnn:
    num_layers: 2
    layer_type: gcn
    activation: relu
    normalize: true
loss:
  _target_: torch_geometric_temporal.nn.recurrent.stock_GNN.adp_adj_loss.AccumulativeGainLoss
  value_decay: 0.9
  penalty_weight: 0.15
  eps: 1.0e-08
  importance_weights:
  - 1.0
  - 0.0
  - 0.0
trainer:
  max_epochs: 11
  min_epochs: 10
  check_val_every_n_epoch: 1
  accelerator: gpu
  devices: 2
  strategy: ddp
  precision: 32
  benchmark: true
  deterministic: false
  gradient_clip_val: 1.0
  gradient_clip_algorithm: norm
  accumulate_grad_batches: 1
  log_every_n_steps: 1
  enable_progress_bar: true
  enable_model_summary: true
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  val_check_interval: 1.0
  enable_checkpointing: true
  default_root_dir: null
  sync_batchnorm: true
  find_unused_parameters: false
  fast_dev_run: false
  overfit_batches: 0
  detect_anomaly: false
  patience: 10
callbacks:
  model_checkpoint:
    _target_: pytorch_lightning.callbacks.ModelCheckpoint
    monitor: val_loss
    filename: stock-gnn-{epoch:02d}-{val_loss:.4f}
    save_top_k: 3
    mode: min
    auto_insert_metric_name: false
    save_last: true
    verbose: true
    every_n_epochs: 1
  early_stopping:
    _target_: pytorch_lightning.callbacks.EarlyStopping
    monitor: val_loss
    patience: 10
    mode: min
    verbose: true
    strict: true
    check_finite: true
    stopping_threshold: null
    divergence_threshold: null
  lr_monitor:
    _target_: pytorch_lightning.callbacks.LearningRateMonitor
    logging_interval: epoch
    log_momentum: false
logger:
  _target_: pytorch_lightning.loggers.TensorBoardLogger
  save_dir: logs
  name: stock_gnn
  version: null
  log_graph: true
  default_hp_metric: true
  prefix: ''
  comment: Stock GNN Factor Mining
  purge_step: null
  max_queue: 10
  flush_secs: 120
  filename_suffix: ''
experiment:
  name: stock_gnn_factor_mining
  version: null
  description: Dynamic GNN for A-share risk factor mining
  tags:
  - stock
  - gnn
  - factor_mining
  - temporal
seed: 42
output_dir: outputs
log_dir: logs
debug:
  enabled: false
  verbose_data_loading: false
  sample_size: null
